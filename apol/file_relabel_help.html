<html>
<head>
<title>File Relabel Analysis</title>
</head>

<body>

<h1>Understanding file relabel analysis</h1>

<p>
The permission to relabel objects in a mandatory access control system
is an important privilege.  In SELinux, this privilege is controlled
by the <code>relabelto</code> and <code>relabelfrom</code>
permissions.  Understanding the net effect of these policy rules is
complex because it requires the examination of multiple rules
potentially spanning dozens of files.  To be able to successfully
relabel an object, a subject must be able to:
</p>

<ul>
<li><code>relabelfrom</code> the starting type</li>
<li><code>relabelto</code> at least one other type</li>
</ul>

<p>
For example, consider the following rules:
</p>

<blockquote>
  <samp>allow sysadm_t filea_t : file relabelfrom;</samp><br>
  <samp>allow sysadm_t { fileb_t filec_t } : file relabelto;</samp>
</blockquote>

<p>
If these rules are the only relabel rules present in the policy,
<samp>sysadm_t</samp> would be allowed to relabel files of type
<samp>filea_t</samp> to <samp>fileb_t</samp> or <samp>filec_t</samp>.
Both a <code>relabelfrom</code> and a <code>relabelto</code> rule for
a single subject must be present for a relabel to be possible.
</p>

<p>
Determining the potential ending types to which a starting type can be
relabeled requires examining all subjects for relabel rules from the
starting type to one or more ending types.  Determining the relabel
privileges of a subject type requires examining all of the relabel
rules containing the subject type.  The direct file relabel analysis
in apol automates both of these analyses.
</p>


<h1>Using direct file relabel analysis in apol</h1>

<p>
Direct file relabel analysis is designed to facilitate querying a
policy for both potential changes to object labels and relabel
privileges granted to a subject.  These two modes are respectively
called <em>Object Mode</em> and <em>Subject Mode</em>.
</p>


<h2>Object Mode</h2>

<p>
In Object Mode, the user specifies a starting or ending type and
either to, from or both.  When <tt>To</tt> is selected, all types to
which the starting type can be relabeled will be displayed.  When
<tt>From</tt> is selected, all types from which the ending type can be
relabeled will be displayed.  If both options are selected, the
analysis performs both.
</p>


<h2>Subject Mode</h2>

<p>
In Subject Mode, the user specifies only a subject type.  Two lists of
types will be displayed corresponding to all of the types to which the
subject can relabel and from which the subject can relabel.
</p>


<h1>Optional result filters</h1>

<p>
Results may be filtered in several ways.  The end types resulting from
a query may be filtered by regular expression.  <tt>Advanced
Filters</tt> provide the option of selecting which object classes to
include in the analysis and which types to include as subjects of
relabeling operations.  The <tt>Subject Types</tt> filter is disabled
in subject mode because all types are excluded as subjects except the
type specified as the required parameter.
</p>

</body>
</html>